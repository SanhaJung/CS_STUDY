## Cookie / Session

> HTTP는 비상태성(Stateless) 프로토콜로 상태 정보를 유지하지 않는다.  
>  연결을 유지하지 않기 때문에 리소스 낭비가 줄어든다는 장점이 있지만 통신을 할 때마다 연결 설정을 해야 하며, 이전 요청과 현재 요청이 같은 사용자의 요청인지 알 수 없다는 단점이 있다.  
> 이 단점은 페이지가 바뀔 때마다 로그인을 다시 한다거나 장바구니에 담아놓은 상품이 사라지는 등 치명적인 부작용을 발생시킨다.

💡서버가 클라이언트를 식별하게 해주는 쿠키와 세션으로 HTTP의 Stateless한 문제점을 해결한다.

### 쿠키와 세션

| ✓         | Cookie                             | Session                |
| --------- | ---------------------------------- | ---------------------- |
| 저장 위치 | 클라이언트                         | 서버                   |
| 저장 형식 | String(Key-Value)                  | Object                 |
| 만료시점  | 쿠키 저장 시 설정                  | 정확한 시점 알 수 없음 |
| 리소스    | 클라이언트의 리소스                | 서버의 리소스          |
| 용량제한  | 한 도메인 당 20개 / 한 쿠키 당 4KB | 제한없음               |

쿠키의 구성요소 - 이름 / 값 / 만료 시간 / 도메인 / 경로

#### [저장위치]

- 쿠키 : 클라이언트의 웹 브라우저가 지정하는 메모리나 하드디스크
- 세션 : 서버의 메모리

#### [만료 시점]

- 쿠키 : 저장할 때 expires 속성을 정의해서 무효화시키면 삭제될 날짜를 정할 수 있다.
- 세션 : 클라이언트가 로그아웃하거나 설정 시간 동안 반응이 없으면 무효화되기 때문에 정확한 시점을 알 수 없다.

#### [리소스]

- 쿠키 : 클라이언트에 저장되며 클라이언트의 메모리를 사용하기 때문에 서버 자원을 사용하지 않는다.
- 세션 : 서버에 저장되고, 서버 메모리로 로딩 되기 때문에 세션이 생길 때마다 리소스를 차지한다.

#### [용량 제한]

- 쿠키 : 클라이언트도 모르게 접속되는 사이트에 의하여 설정될 수 있기 때문에 쿠키로 인해 문제가 발생하는 것을 막고자 한 도메인 당 20개, 하나의 쿠기 당 4KB로 제한
- 세션 : 클라이언트 접속 시 서버에 의해 생성되므로 개수와 용량 제한이 없다.

#### [보안성]

- 쿠키 : 사용자에게 저장되기 때문에, 임의로 수정/삭제가 가능하고 가로채기 쉬워서 보안이 취약하다.
- 세션 : 서버에 저장하여 쿠키보단 보안에 좋지만, 사용자가 많아질수록 서버 메모리를 많이 차지한다.

<hr/>

### 예상 질문

📌 쿠키와 세션을 사용하는 이유가 무엇인가요?

> HTTP는 비상태성 프로토콜로 상태 정보를 유지하지 않습니다. 이는 통신을 할 때마다 연결 설정을 해야 하고 같은 사용자의 요청도 새로운 사용자로 인식하기 때문에 페이지 이동 시마다 로그인을 다시 하거나 장바구니 목록이 사라지는 치명적인 단점이 있습니다. 쿠키와 세션을 사용하여 서버가 클라이언트를 구분할 수 있게 함으로써 HTTP의 비상태성 문제를 해결할 수 있습니다.

<br/>
📌 쿠키는 보안성이 낮으니까 모든 정보를 세션에 저장하면 되지 않나요?  

> 모든 정보를 세션에 저장하게 되면 서버의 메모리를 과도하게 사용하게 되어 서버에 무리가 가기 때문에 쿠키와 세션을 적절히 사용합니다.
